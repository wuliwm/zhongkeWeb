import{E as He}from"./button-DUk0u3m-.js";import{E as Qe,v as Xe,S as Ge}from"./StatusTag-BmSEEcUz.js";import{c as Je,r as Ye,a as W,b as Ze,E as et,d as tt,e as at}from"./table-column-1ylQhltR.js";import"./tooltip-CvN_r9uv.js";import{U as Pe,E as st}from"./input-C1yLYa_0.js";import{o as nt}from"./checkbox-CB6I17pB.js";import{aw as ie,d as K,ad as lt,ax as J,I as pe,ay as ot,az as rt,l as te,an as ce,m as Z,s as Re,K as me,aa as he,t as ae,r as E,z as H,ao as ue,Q as $e,c as Q,o as j,C as ze,F as Be,j as V,ac as de,X as ee,aA as it,aB as ct,v as z,aC as Se,aD as ut,f as o,E as Y,aE as dt,ab as vt,R as ve,a0 as q,aF as bt,x as ft,p as pt,B as be,aG as mt,L as Oe,J as ht,aH as gt,aI as we,a as fe,aJ as _t,ae as Ae,a1 as yt,af as Ct,G as Nt,N as St,e as P,w as O,a5 as Ee,ar as Te,aK as wt,i as ke,A as Et,M as D,h as Tt,k as kt}from"./index-C46IBHsc.js";import{C as xt}from"./CountdownTimer-_uC7ufbI.js";import{f as Pt}from"./vnode-CjbdVNW3.js";import"./_commonjsHelpers-Cpj98o6Y.js";const Rt=(t,r,i)=>Pt(t.subTree).filter(e=>{var S;return ot(e)&&((S=e.type)==null?void 0:S.name)===r&&!!e.component}).map(e=>e.component.uid).map(e=>i[e]).filter(e=>!!e),$t=(t,r)=>{const i=ie({}),g=ie([]),n=new WeakMap,e=C=>{i.value[C.uid]=C,J(i),pe(()=>{const f=C.getVnode().el,s=f.parentNode;if(!n.has(s)){n.set(s,[]);const v=s.insertBefore.bind(s);s.insertBefore=(w,a)=>(n.get(s).some(p=>w===p||a===p)&&J(i),v(w,a))}n.get(s).push(f)})},S=C=>{delete i.value[C.uid],J(i);const f=C.getVnode().el,s=f.parentNode,v=n.get(s),w=v.indexOf(f);v.splice(w,1)},m=()=>{g.value=Rt(t,r,i.value)},c=C=>C.render(),h=K({setup(C,{slots:f}){return()=>(m(),f.default?lt(c,{render:f.default}):null)}});return{children:g,addChild:e,removeChild:S,ChildrenSorter:h}},zt="horizontal",Bt="vertical",Ot={[zt]:"deltaX",[Bt]:"deltaY"},At=({atEndEdge:t,atStartEdge:r,layout:i},g)=>{let n,e=0;const S=c=>c<0&&r.value||c>0&&t.value;return{hasReachedEdge:S,onWheel:c=>{Je(n);const h=c[Ot[i.value]];S(e)&&S(e+h)||(e+=h,rt()||c.preventDefault(),n=Ye(()=>{g(e),e=0}))}}},se=Symbol("tabsRootContextKey"),Ft=te({tabs:{type:Z(Array),default:()=>ce([])},tabRefs:{type:Z(Object),default:()=>ce({})}}),Fe="ElTabBar",Vt=K({name:Fe}),Lt=K({...Vt,props:Ft,setup(t,{expose:r}){const i=t,g=me(se);g||he(Fe,"<el-tabs><el-tab-bar /></el-tabs>");const n=ae("tabs"),e=E(),S=E(),m=()=>{let s=0,v=0;const w=["top","bottom"].includes(g.props.tabPosition)?"width":"height",a=w==="width"?"x":"y",_=a==="x"?"left":"top";return i.tabs.every(p=>{if(de(p.paneName))return!1;const k=i.tabRefs[p.paneName];if(!k)return!1;if(!p.active)return!0;s=k[`offset${W(_)}`],v=k[`client${W(w)}`];const l=window.getComputedStyle(k);return w==="width"&&(v-=Number.parseFloat(l.paddingLeft)+Number.parseFloat(l.paddingRight),s+=Number.parseFloat(l.paddingLeft)),!1}),{[w]:`${v}px`,transform:`translate${W(a)}(${s}px)`}},c=()=>S.value=m(),h=[],C=()=>{h.forEach(s=>s.stop()),h.length=0,Object.values(i.tabRefs).forEach(s=>{h.push(ue(s,c))})};H(()=>i.tabs,async()=>{await ee(),c(),C()},{immediate:!0});const f=ue(e,()=>c());return $e(()=>{h.forEach(s=>s.stop()),h.length=0,f.stop()}),r({ref:e,update:c}),(s,v)=>(j(),Q("div",{ref_key:"barRef",ref:e,class:Be([V(n).e("active-bar"),V(n).is(V(g).props.tabPosition)]),style:ze(S.value)},null,6))}});var It=Re(Lt,[["__file","tab-bar.vue"]]);const Mt=te({panes:{type:Z(Array),default:()=>ce([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean,tabindex:{type:[String,Number],default:void 0}}),Dt={tabClick:(t,r,i)=>i instanceof Event,tabRemove:(t,r)=>r instanceof Event},xe="ElTabNav",qt=K({name:xe,props:Mt,emits:Dt,setup(t,{expose:r,emit:i}){const g=me(se);g||he(xe,"<el-tabs><tab-nav /></el-tabs>");const n=ae("tabs"),e=it(),S=ct(),m=E(),c=E(),h=E(),C=E({}),f=E(),s=E(!1),v=E(0),w=E(!1),a=E(!0),_=ie(),p=z(()=>["top","bottom"].includes(g.props.tabPosition)),k=z(()=>p.value?"width":"height"),l=z(()=>({transform:`translate${k.value==="width"?"X":"Y"}(-${v.value}px)`})),{width:x,height:T}=Se(m),{width:A,height:L}=Se(c,{width:0,height:0},{box:"border-box"}),U=z(()=>p.value?x.value:T.value),F=z(()=>p.value?A.value:L.value),{onWheel:b}=At({atStartEdge:z(()=>v.value<=0),atEndEdge:z(()=>F.value-v.value<=U.value),layout:z(()=>p.value?"horizontal":"vertical")},u=>{v.value=Ze(v.value+u,0,F.value-U.value)}),X=()=>{if(!m.value)return;const u=m.value[`offset${W(k.value)}`],N=v.value;if(!N)return;const d=N>u?N-u:0;v.value=d},Ie=()=>{if(!m.value||!c.value)return;const u=c.value[`offset${W(k.value)}`],N=m.value[`offset${W(k.value)}`],d=v.value;if(u-d<=N)return;const y=u-d>N*2?d+N:u-N;v.value=y},ge=async()=>{const u=c.value;if(!s.value||!h.value||!m.value||!u)return;await ee();const N=C.value[t.currentName];if(!N)return;const d=m.value,y=N.getBoundingClientRect(),R=d.getBoundingClientRect(),$=p.value?u.offsetWidth-R.width:u.offsetHeight-R.height,I=v.value;let B=I;p.value?(y.left<R.left&&(B=I-(R.left-y.left)),y.right>R.right&&(B=I+y.right-R.right)):(y.top<R.top&&(B=I-(R.top-y.top)),y.bottom>R.bottom&&(B=I+(y.bottom-R.bottom))),B=Math.max(B,0),v.value=Math.min(B,$)},_e=()=>{var u;if(!c.value||!m.value)return;t.stretch&&((u=f.value)==null||u.update());const N=c.value[`offset${W(k.value)}`],d=m.value[`offset${W(k.value)}`],y=v.value;d<N?(s.value=s.value||{},s.value.prev=y,s.value.next=y+d<N,N-y<d&&(v.value=N-d)):(s.value=!1,y>0&&(v.value=0))},Me=u=>{const N=ve(u);let d=0;switch(N){case q.left:case q.up:d=-1;break;case q.right:case q.down:d=1;break;default:return}const y=Array.from(u.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let $=y.indexOf(u.target)+d;$<0?$=y.length-1:$>=y.length&&($=0),y[$].focus({preventScroll:!0}),y[$].click(),ye()},ye=()=>{a.value&&(w.value=!0)},ne=()=>w.value=!1,De=(u,N)=>{C.value[N]=u},qe=async()=>{await ee();const u=C.value[t.currentName];u?.focus({preventScroll:!0})};return H(e,u=>{u==="hidden"?a.value=!1:u==="visible"&&setTimeout(()=>a.value=!0,50)}),H(S,u=>{u?setTimeout(()=>a.value=!0,50):a.value=!1}),ue(h,_e),pe(()=>setTimeout(()=>ge(),0)),ut(()=>_e()),r({scrollToActiveTab:ge,removeFocus:ne,focusActiveTab:qe,tabListRef:c,tabBarRef:f,scheduleRender:()=>J(_)}),()=>{const u=s.value?[o("span",{class:[n.e("nav-prev"),n.is("disabled",!s.value.prev)],onClick:X},[o(Y,null,{default:()=>[o(dt,null,null)]})]),o("span",{class:[n.e("nav-next"),n.is("disabled",!s.value.next)],onClick:Ie},[o(Y,null,{default:()=>[o(vt,null,null)]})])]:null,N=t.panes.map((d,y)=>{var R,$,I,B,Ce;const We=d.uid,le=d.props.disabled,G=($=(R=d.props.name)!=null?R:d.index)!=null?$:`${y}`,oe=!le&&(d.isClosable||d.props.closable!==!1&&t.editable);d.index=`${y}`;const Ke=oe?o(Y,{class:"is-icon-close",onClick:M=>i("tabRemove",d,M)},{default:()=>[o(bt,null,null)]}):null,Ue=((B=(I=d.slots).label)==null?void 0:B.call(I))||d.props.label,je=!le&&d.active?(Ce=t.tabindex)!=null?Ce:g.props.tabindex:-1;return o("div",{ref:M=>De(M,G),class:[n.e("item"),n.is(g.props.tabPosition),n.is("active",d.active),n.is("disabled",le),n.is("closable",oe),n.is("focus",w.value)],id:`tab-${G}`,key:`tab-${We}`,"aria-controls":`pane-${G}`,role:"tab","aria-selected":d.active,tabindex:je,onFocus:()=>ye(),onBlur:()=>ne(),onClick:M=>{ne(),i("tabClick",d,G,M)},onKeydown:M=>{const Ne=ve(M);oe&&(Ne===q.delete||Ne===q.backspace)&&i("tabRemove",d,M)}},[Ue,Ke])});return _.value,o("div",{ref:h,class:[n.e("nav-wrap"),n.is("scrollable",!!s.value),n.is(g.props.tabPosition)]},[u,o("div",{class:n.e("nav-scroll"),ref:m},[t.panes.length>0?o("div",{class:[n.e("nav"),n.is(g.props.tabPosition),n.is("stretch",t.stretch&&["top","bottom"].includes(g.props.tabPosition))],ref:c,style:l.value,role:"tablist",onKeydown:Me,onWheel:b},[t.type?null:o(It,{ref:f,tabs:[...t.panes],tabRefs:C.value},null),N]):null])])}}}),Wt=te({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:Z(Function),default:()=>!0},stretch:Boolean,tabindex:{type:[String,Number],default:0}}),re=t=>ft(t)||pt(t),Kt={[Pe]:t=>re(t),tabClick:(t,r)=>r instanceof Event,tabChange:t=>re(t),edit:(t,r)=>["remove","add"].includes(r),tabRemove:t=>re(t),tabAdd:()=>!0},Ut=K({name:"ElTabs",props:Wt,emits:Kt,setup(t,{emit:r,slots:i,expose:g}){var n;const e=ae("tabs"),S=z(()=>["left","right"].includes(t.tabPosition)),{children:m,addChild:c,removeChild:h,ChildrenSorter:C}=$t(Oe(),"ElTabPane"),f=E(),s=E((n=t.modelValue)!=null?n:"0"),v=async(l,x=!1)=>{var T,A,L,U;if(!(s.value===l||de(l)))try{let F;if(t.beforeLeave){const b=t.beforeLeave(l,s.value);F=b instanceof Promise?await b:b}else F=!0;if(F!==!1){const b=(T=m.value.find(X=>X.paneName===s.value))==null?void 0:T.isFocusInsidePane();s.value=l,x&&(r(Pe,l),r("tabChange",l)),(L=(A=f.value)==null?void 0:A.removeFocus)==null||L.call(A),b&&((U=f.value)==null||U.focusActiveTab())}}catch{}},w=(l,x,T)=>{l.props.disabled||(r("tabClick",l,T),v(x,!0))},a=(l,x)=>{l.props.disabled||de(l.props.name)||(x.stopPropagation(),r("edit",l.props.name,"remove"),r("tabRemove",l.props.name))},_=()=>{r("edit",void 0,"add"),r("tabAdd")},p=l=>{const x=ve(l);[q.enter,q.numpadEnter].includes(x)&&_()},k=l=>{const x=l.el.firstChild,T=["bottom","right"].includes(t.tabPosition)?l.children[0].el:l.children[1].el;x!==T&&x.before(T)};return H(()=>t.modelValue,l=>v(l)),H(s,async()=>{var l;await ee(),(l=f.value)==null||l.scrollToActiveTab()}),ht(se,{props:t,currentName:s,registerPane:c,unregisterPane:h,nav$:f}),g({currentName:s,get tabNavRef(){return nt(f.value,["scheduleRender"])}}),()=>{const l=i["add-icon"],x=t.editable||t.addable?o("div",{class:[e.e("new-tab"),S.value&&e.e("new-tab-vertical")],tabindex:t.tabindex,onClick:_,onKeydown:p},[l?be(i,"add-icon"):o(Y,{class:e.is("icon-plus")},{default:()=>[o(mt,null,null)]})]):null,T=()=>o(qt,{ref:f,currentName:s.value,editable:t.editable,type:t.type,panes:m.value,stretch:t.stretch,onTabClick:w,onTabRemove:a},null),A=o("div",{class:[e.e("header"),S.value&&e.e("header-vertical"),e.is(t.tabPosition)]},[o(C,null,{default:T,$stable:!0}),x]),L=o("div",{class:e.e("content")},[be(i,"default")]);return o("div",{class:[e.b(),e.m(t.tabPosition),{[e.m("card")]:t.type==="card",[e.m("border-card")]:t.type==="border-card"}],onVnodeMounted:k,onVnodeUpdated:k},[L,A])}}});var jt=Ut;const Ht=te({label:{type:String,default:""},name:{type:[String,Number]},closable:{type:Boolean,default:void 0},disabled:Boolean,lazy:Boolean}),Ve="ElTabPane",Qt=K({name:Ve}),Xt=K({...Qt,props:Ht,setup(t){const r=t,i=Oe(),g=gt(),n=me(se);n||he(Ve,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const e=ae("tab-pane"),S=E(),m=E(),c=z(()=>{var a;return(a=r.closable)!=null?a:n.props.closable}),h=we(()=>{var a;return n.currentName.value===((a=r.name)!=null?a:m.value)}),C=E(h.value),f=z(()=>{var a;return(a=r.name)!=null?a:m.value}),s=we(()=>!r.lazy||C.value||h.value),v=()=>{var a;return(a=S.value)==null?void 0:a.contains(document.activeElement)};H(h,a=>{a&&(C.value=!0)});const w=fe({uid:i.uid,getVnode:()=>i.vnode,slots:g,props:r,paneName:f,active:h,index:m,isClosable:c,isFocusInsidePane:v});return n.registerPane(w),$e(()=>{n.unregisterPane(w)}),_t(()=>{var a;g.label&&((a=n.nav$.value)==null||a.scheduleRender())}),(a,_)=>V(s)?Ae((j(),Q("div",{key:0,id:`pane-${V(f)}`,ref_key:"paneRef",ref:S,class:Be(V(e).b()),role:"tabpanel","aria-hidden":!V(h),"aria-labelledby":`tab-${V(f)}`},[be(a.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[Ct,V(h)]]):yt("v-if",!0)}});var Le=Re(Xt,[["__file","tab-pane.vue"]]);const Gt=Nt(jt,{TabPane:Le}),Jt=St(Le),Yt={class:"page"},Zt={class:"page-header"},ea={class:"statistics"},ta={class:"stat-label"},aa={class:"stat-value"},sa={class:"quotation-info"},na={class:"code"},la={class:"project"},oa={class:"meta"},ra={class:"timeline"},ia={class:"pagination"},ca=K({__name:"QuotationList",setup(t){const r=Tt(),i=E(!1),g=E([]),n=fe({total:0}),e=fe({status:"all",keyword:"",page:1,pageSize:10}),S=[{label:"全部",value:"all"},{label:"待报价",value:"pending"},{label:"已报价",value:"quoted"},{label:"已过期",value:"expired"},{label:"已截止",value:"closed"}],m=E([{label:"待报价",value:0,key:"pending",color:"#f59e0b"},{label:"已报价",value:0,key:"quoted",color:"#10b981"},{label:"进行中",value:0,key:"running",color:"#6366f1"},{label:"已过期",value:0,key:"expired",color:"#ef4444"}]),c=async()=>{i.value=!0;try{const a=await wt.quotations.getList({page:e.page,pageSize:e.pageSize,status:e.status==="all"?void 0:e.status,keyword:e.keyword||void 0,sortBy:"endDate",sortOrder:"asc"});g.value=a.list,n.total=a.total,h(a.list)}finally{i.value=!1}},h=a=>{const _={pending:0,quoted:0,expired:0,closed:0,awarded:0};a.forEach(p=>{_[p.status]=(_[p.status]??0)+1}),m.value=m.value.map(p=>p.key==="running"?{...p,value:_.pending+_.quoted}:p.key==="expired"?{...p,value:_.expired+_.closed}:{...p,value:_[p.key]??0})},C=a=>{e.status=String(a),e.page=1,c()},f=()=>{e.page=1,c()},s=a=>{e.page=a,c()},v=a=>{e.pageSize=a,e.page=1,c()},w=a=>{r.push(`/quotations/${a}`)};return pe(c),H(()=>e.keyword,a=>{a||c()}),(a,_)=>{const p=He,k=st,l=Jt,x=Gt,T=et,A=at,L=tt,U=Qe,F=Xe;return j(),Q("div",Yt,[P("header",Zt,[_[2]||(_[2]=P("div",{class:"title-block"},[P("h1",null,"报价单列表"),P("p",null,"查看分配给您的所有报价任务，实时掌握截止时间与进度。")],-1)),o(k,{modelValue:e.keyword,"onUpdate:modelValue":_[0]||(_[0]=b=>e.keyword=b),modelModifiers:{trim:!0},placeholder:"搜索报价单号 / 项目名称",class:"search-input",clearable:"",onClear:f},{append:O(()=>[o(p,{type:"primary",onClick:f},{default:O(()=>[..._[1]||(_[1]=[ke("搜索",-1)])]),_:1})]),_:1},8,["modelValue"])]),P("section",ea,[(j(!0),Q(Ee,null,Te(m.value,b=>(j(),Q("div",{key:b.key,class:"stat-card",style:ze({borderColor:b.color})},[P("p",ta,D(b.label),1),P("p",aa,D(b.value),1)],4))),128))]),o(U,{class:"content-card"},{default:O(()=>[o(x,{"model-value":e.status,onTabChange:C},{default:O(()=>[(j(),Q(Ee,null,Te(S,b=>o(l,{key:b.value,label:b.label,name:b.value},null,8,["label","name"])),64))]),_:1},8,["model-value"]),Ae((j(),Et(A,{data:g.value,class:"quotation-table",stripe:""},{default:O(()=>[o(T,{label:"报价单信息","min-width":"280"},{default:O(({row:b})=>[P("div",sa,[P("div",na,"#"+D(b.quotationNo),1),P("div",la,D(b.projectName),1),P("div",oa,[P("span",null,"氚云编号："+D(b.qingyunId),1)])])]),_:1}),o(T,{label:"报价周期","min-width":"220"},{default:O(({row:b})=>[P("div",ra,[P("span",null,D(b.startDate.slice(0,10))+" ~ "+D(b.endDate.slice(0,10)),1),o(xt,{"end-date":b.endDate},null,8,["end-date"])])]),_:1}),o(T,{prop:"itemCount",label:"物品数",width:"120",align:"center"}),o(T,{label:"状态",width:"140",align:"center"},{default:O(({row:b})=>[o(Ge,{status:b.status,size:"small"},null,8,["status"])]),_:1}),o(T,{label:"操作",width:"160",align:"center"},{default:O(({row:b})=>[o(p,{type:"primary",link:"",onClick:X=>w(b.id)},{default:O(()=>[ke(D(b.status==="quoted"?"查看详情":"立即报价"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[F,i.value]]),P("div",ia,[o(L,{background:"",layout:"prev, pager, next, sizes, jumper",total:n.total,"page-size":e.pageSize,"current-page":e.page,"page-sizes":[10,20,30,50],onCurrentChange:s,onSizeChange:v},null,8,["total","page-size","current-page"])])]),_:1})])}}}),ya=kt(ca,[["__scopeId","data-v-0441ac47"]]);export{ya as default};
