import{b as ct,d as dt,u as ft,e as mt,E as pt}from"./button-DeWLp135.js";import{d as vt,g as We,v as gt,S as bt,E as yt}from"./StatusTag-B9hT7TF-.js";import{E as ht,a as _t,b as wt}from"./form-item-CcqWeoeW.js";import{C as ze,u as It,U as ge,I as Ce,E as Ge}from"./input-ClmlybEh.js";import{v as je,E as Nt,a as Et}from"./descriptions-item-2XOOvsv1.js";import{aL as kt,aM as Ue,p as H,l as ye,m as ee,s as he,d as Z,t as _e,aw as xe,aN as Vt,aO as Ke,r as R,v as N,y as St,z as me,I as Se,aa as Ze,W as be,aj as $t,c as B,o as w,e as v,B as U,C as ve,F as A,j as t,X as Te,G as we,an as pe,K as Ct,ai as xt,A as j,w as c,D as Me,aP as Xe,aQ as Tt,aR as zt,H as Fe,aS as Rt,aT as Pt,aU as At,f as u,T as Lt,a1 as q,a4 as Qe,E as ne,aF as Ot,a5 as Ve,aE as Dt,ab as Mt,i as se,M as x,aV as Ft,aW as Bt,aX as qt,aY as jt,aZ as Ut,R as Je,a0 as fe,a_ as Kt,a$ as Xt,b0 as Ne,ah as Yt,O as Ye,a2 as et,Z as Pe,$ as Ae,b1 as Ht,x as tt,b2 as Wt,b3 as Gt,b4 as Zt,ak as ke,b5 as Qt,a as at,ac as $e,aq as Ee,aD as Jt,ae as De,b6 as He,a3 as ea,b7 as ta,b8 as aa,aG as la,b9 as sa,J as na,ar as lt,k as st,g as oa,ba as ra,h as ia,aK as Le}from"./index-8FSIx1qK.js";import{C as ua}from"./CountdownTimer-C9bansnb.js";import{E as ca,a as da}from"./vnode-Fa30P996.js";import"./_commonjsHelpers-Cpj98o6Y.js";var fa="Expected a function";function Oe(o,h,m){var l=!0,b=!0;if(typeof o!="function")throw new TypeError(fa);return kt(m)&&(l="leading"in m?!!m.leading:l,b="trailing"in m?!!m.trailing:b),vt(o,h,{leading:l,maxWait:h,trailing:b})}const ma=ye({zIndex:{type:ee([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),pa={scroll:({scrollTop:o,fixed:h})=>H(o)&&Ue(h),[ze]:o=>Ue(o)},nt="ElAffix",va=Z({name:nt}),ga=Z({...va,props:ma,emits:pa,setup(o,{expose:h,emit:m}){const l=o,b=_e("affix"),g=xe(),a=xe(),p=xe(),{height:L}=Vt(),{height:r,width:$,top:C,bottom:K,update:P}=Ke(a,{windowScroll:!1}),T=Ke(g),k=R(!1),O=R(0),y=R(0),Q=N(()=>({height:k.value?`${r.value}px`:"",width:k.value?`${$.value}px`:""})),V=N(()=>{if(!k.value)return{};const _=l.offset?St(l.offset):0;return{height:`${r.value}px`,width:`${$.value}px`,top:l.position==="top"?_:"",bottom:l.position==="bottom"?_:"",transform:y.value?`translateY(${y.value}px)`:"",zIndex:l.zIndex}}),te=()=>{if(!p.value)return;O.value=p.value instanceof Window?document.documentElement.scrollTop:p.value.scrollTop||0;const{position:_,target:M,offset:J}=l,W=J+r.value;if(_==="top")if(M){const X=T.bottom.value-W;k.value=J>C.value&&T.bottom.value>0,y.value=X<0?X:0}else k.value=J>C.value;else if(M){const X=L.value-T.top.value-W;k.value=L.value-J<K.value&&L.value>T.top.value,y.value=X<0?-X:0}else k.value=L.value-J<K.value},I=async()=>{if(!k.value){P();return}k.value=!1,await Te(),P(),k.value=!0},n=async()=>{P(),await Te(),m("scroll",{scrollTop:O.value,fixed:k.value})};return me(k,_=>m(ze,_)),Se(()=>{var _;l.target?(g.value=(_=document.querySelector(l.target))!=null?_:void 0,g.value||Ze(nt,`Target does not exist: ${l.target}`)):g.value=document.documentElement,p.value=We(a.value,!0),P()}),be(p,"scroll",n),$t(te),h({update:te,updateRoot:I}),(_,M)=>(w(),B("div",{ref_key:"root",ref:a,class:A(t(b).b()),style:ve(t(Q))},[v("div",{class:A({[t(b).m("fixed")]:k.value}),style:ve(t(V))},[U(_.$slots,"default")],6)],6))}});var ba=he(ga,[["__file","affix.vue"]]);const ya=we(ba),ha=ye({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:ee([Number,Object]),default:()=>pe({})},sm:{type:ee([Number,Object]),default:()=>pe({})},md:{type:ee([Number,Object]),default:()=>pe({})},lg:{type:ee([Number,Object]),default:()=>pe({})},xl:{type:ee([Number,Object]),default:()=>pe({})}}),ot=Symbol("rowContextKey"),_a=Z({name:"ElCol"}),wa=Z({..._a,props:ha,setup(o){const h=o,{gutter:m}=Ct(ot,{gutter:N(()=>0)}),l=_e("col"),b=N(()=>{const a={};return m.value&&(a.paddingLeft=a.paddingRight=`${m.value/2}px`),a}),g=N(()=>{const a=[];return["span","offset","pull","push"].forEach(r=>{const $=h[r];H($)&&(r==="span"?a.push(l.b(`${h[r]}`)):$>0&&a.push(l.b(`${r}-${h[r]}`)))}),["xs","sm","md","lg","xl"].forEach(r=>{H(h[r])?a.push(l.b(`${r}-${h[r]}`)):xt(h[r])&&Object.entries(h[r]).forEach(([$,C])=>{a.push($!=="span"?l.b(`${r}-${$}-${C}`):l.b(`${r}-${C}`))})}),m.value&&a.push(l.is("guttered")),[l.b(),a]});return(a,p)=>(w(),j(Me(a.tag),{class:A(t(g)),style:ve(t(b))},{default:c(()=>[U(a.$slots,"default")]),_:3},8,["class","style"]))}});var Ia=he(wa,[["__file","col.vue"]]);const Na=we(Ia),Ea=ye({urlList:{type:ee(Array),default:()=>pe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:ee(String)}}),ka={close:()=>!0,error:o=>o instanceof Event,switch:o=>H(o),rotate:o=>H(o)},Va=Z({name:"ElImageViewer"}),Sa=Z({...Va,props:Ea,emits:ka,setup(o,{expose:h,emit:m}){var l;const b=o,g={CONTAIN:{name:"contain",icon:Xe(zt)},ORIGINAL:{name:"original",icon:Xe(Tt)}};let a,p="";const{t:L}=Fe(),r=_e("image-viewer"),{nextZIndex:$}=Rt(),C=R(),K=R(),P=Pt(),T=N(()=>{const{scale:i,minScale:F,maxScale:D}=b;return At(i,F,D)}),k=R(!0),O=R(!1),y=R(b.initialIndex),Q=xe(g.CONTAIN),V=R({scale:T.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),te=R((l=b.zIndex)!=null?l:$()),I=N(()=>{const{urlList:i}=b;return i.length<=1}),n=N(()=>y.value===0),_=N(()=>y.value===b.urlList.length-1),M=N(()=>b.urlList[y.value]),J=N(()=>[r.e("btn"),r.e("prev"),r.is("disabled",!b.infinite&&n.value)]),W=N(()=>[r.e("btn"),r.e("next"),r.is("disabled",!b.infinite&&_.value)]),X=N(()=>{const{scale:i,deg:F,offsetX:D,offsetY:oe,enableTransition:ce}=V.value;let le=D/i,de=oe/i;const Ie=F*Math.PI/180,Be=Math.cos(Ie),qe=Math.sin(Ie);le=le*Be+de*qe,de=de*Be-D/i*qe;const Re={transform:`scale(${i}) rotate(${F}deg) translate(${le}px, ${de}px)`,transition:ce?"transform .3s":""};return Q.value.name===g.CONTAIN.name&&(Re.maxWidth=Re.maxHeight="100%"),Re}),G=N(()=>`${y.value+1} / ${b.urlList.length}`);function Y(){re(),a?.(),document.body.style.overflow=p,m("close")}function ae(){const i=Oe(D=>{switch(Je(D)){case fe.esc:b.closeOnPressEscape&&Y();break;case fe.space:d();break;case fe.left:ie();break;case fe.up:z("zoomIn");break;case fe.right:ue();break;case fe.down:z("zoomOut");break}}),F=Oe(D=>{const oe=D.deltaY||D.deltaX;z(oe<0?"zoomIn":"zoomOut",{zoomRate:b.zoomRate,enableTransition:!1})});P.run(()=>{be(document,"keydown",i),be(document,"wheel",F)})}function re(){P.stop()}function e(){k.value=!1}function s(i){O.value=!0,k.value=!1,m("error",i),i.target.alt=L("el.image.error")}function f(i){if(k.value||i.button!==0||!C.value)return;V.value.enableTransition=!1;const{offsetX:F,offsetY:D}=V.value,oe=i.pageX,ce=i.pageY,le=Oe(Ie=>{V.value={...V.value,offsetX:F+Ie.pageX-oe,offsetY:D+Ie.pageY-ce}}),de=be(document,"mousemove",le);be(document,"mouseup",()=>{de()}),i.preventDefault()}function E(){V.value={scale:T.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function d(){if(k.value||O.value)return;const i=Ut(g),F=Object.values(g),D=Q.value.name,ce=(F.findIndex(le=>le.name===D)+1)%i.length;Q.value=g[i[ce]],E()}function S(i){O.value=!1;const F=b.urlList.length;y.value=(i+F)%F}function ie(){n.value&&!b.infinite||S(y.value-1)}function ue(){_.value&&!b.infinite||S(y.value+1)}function z(i,F={}){if(k.value||O.value)return;const{minScale:D,maxScale:oe}=b,{zoomRate:ce,rotateDeg:le,enableTransition:de}={zoomRate:b.zoomRate,rotateDeg:90,enableTransition:!0,...F};switch(i){case"zoomOut":V.value.scale>D&&(V.value.scale=Number.parseFloat((V.value.scale/ce).toFixed(3)));break;case"zoomIn":V.value.scale<oe&&(V.value.scale=Number.parseFloat((V.value.scale*ce).toFixed(3)));break;case"clockwise":V.value.deg+=le,m("rotate",V.value.deg);break;case"anticlockwise":V.value.deg-=le,m("rotate",V.value.deg);break}V.value.enableTransition=de}function rt(i){var F;((F=i.detail)==null?void 0:F.focusReason)==="pointer"&&i.preventDefault()}function it(){b.closeOnPressEscape&&Y()}function ut(i){if(i.ctrlKey){if(i.deltaY<0)return i.preventDefault(),!1;if(i.deltaY>0)return i.preventDefault(),!1}}return me(()=>T.value,i=>{V.value.scale=i}),me(M,()=>{Te(()=>{const i=K.value;i?.complete||(k.value=!0)})}),me(y,i=>{E(),m("switch",i)}),Se(()=>{ae(),a=be("wheel",ut,{passive:!1}),p=document.body.style.overflow,document.body.style.overflow="hidden"}),h({setActiveItem:S}),(i,F)=>(w(),j(t(da),{to:"body",disabled:!i.teleported},{default:c(()=>[u(Lt,{name:"viewer-fade",appear:""},{default:c(()=>[v("div",{ref_key:"wrapper",ref:C,tabindex:-1,class:A(t(r).e("wrapper")),style:ve({zIndex:te.value})},[u(t(ca),{loop:"",trapped:"","focus-trap-el":C.value,"focus-start-el":"container",onFocusoutPrevented:rt,onReleaseRequested:it},{default:c(()=>[v("div",{class:A(t(r).e("mask")),onClick:Qe(D=>i.hideOnClickModal&&Y(),["self"])},null,10,["onClick"]),q(" CLOSE "),v("span",{class:A([t(r).e("btn"),t(r).e("close")]),onClick:Y},[u(t(ne),null,{default:c(()=>[u(t(Ot))]),_:1})],2),q(" ARROW "),t(I)?q("v-if",!0):(w(),B(Ve,{key:0},[v("span",{class:A(t(J)),onClick:ie},[u(t(ne),null,{default:c(()=>[u(t(Dt))]),_:1})],2),v("span",{class:A(t(W)),onClick:ue},[u(t(ne),null,{default:c(()=>[u(t(Mt))]),_:1})],2)],64)),i.$slots.progress||i.showProgress?(w(),B("div",{key:1,class:A([t(r).e("btn"),t(r).e("progress")])},[U(i.$slots,"progress",{activeIndex:y.value,total:i.urlList.length},()=>[se(x(t(G)),1)])],2)):q("v-if",!0),q(" ACTIONS "),v("div",{class:A([t(r).e("btn"),t(r).e("actions")])},[v("div",{class:A(t(r).e("actions__inner"))},[U(i.$slots,"toolbar",{actions:z,prev:ie,next:ue,reset:d,activeIndex:y.value,setActiveItem:S},()=>[u(t(ne),{onClick:D=>z("zoomOut")},{default:c(()=>[u(t(Ft))]),_:1},8,["onClick"]),u(t(ne),{onClick:D=>z("zoomIn")},{default:c(()=>[u(t(Bt))]),_:1},8,["onClick"]),v("i",{class:A(t(r).e("actions__divider"))},null,2),u(t(ne),{onClick:d},{default:c(()=>[(w(),j(Me(t(Q).icon)))]),_:1}),v("i",{class:A(t(r).e("actions__divider"))},null,2),u(t(ne),{onClick:D=>z("anticlockwise")},{default:c(()=>[u(t(qt))]),_:1},8,["onClick"]),u(t(ne),{onClick:D=>z("clockwise")},{default:c(()=>[u(t(jt))]),_:1},8,["onClick"])])],2)],2),q(" CANVAS "),v("div",{class:A(t(r).e("canvas"))},[O.value&&i.$slots["viewer-error"]?U(i.$slots,"viewer-error",{key:0,activeIndex:y.value,src:t(M)}):(w(),B("img",{ref_key:"imgRef",ref:K,key:t(M),src:t(M),style:ve(t(X)),class:A(t(r).e("img")),crossorigin:i.crossorigin,onLoad:e,onError:s,onMousedown:f},null,46,["src","crossorigin"]))],2),U(i.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var $a=he(Sa,[["__file","image-viewer.vue"]]);const Ca=we($a),xa=ye({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:ee([String,Object])},previewSrcList:{type:ee(Array),default:()=>pe([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:ee(String)}}),Ta={load:o=>o instanceof Event,error:o=>o instanceof Event,switch:o=>H(o),close:()=>!0,show:()=>!0},za=Z({name:"ElImage",inheritAttrs:!1}),Ra=Z({...za,props:xa,emits:Ta,setup(o,{expose:h,emit:m}){const l=o,{t:b}=Fe(),g=_e("image"),a=Kt(),p=N(()=>Xt(Object.entries(a).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),L=It({excludeListeners:!0,excludeKeys:N(()=>Object.keys(p.value))}),r=R(),$=R(!1),C=R(!0),K=R(!1),P=R(),T=R(),k=Ne&&"loading"in HTMLImageElement.prototype;let O;const y=N(()=>[g.e("inner"),V.value&&g.e("preview"),C.value&&g.is("loading")]),Q=N(()=>{const{fit:e}=l;return Ne&&e?{objectFit:e}:{}}),V=N(()=>{const{previewSrcList:e}=l;return Yt(e)&&e.length>0}),te=N(()=>{const{previewSrcList:e,initialIndex:s}=l;let f=s;return s>e.length-1&&(f=0),f}),I=N(()=>l.loading==="eager"?!1:!k&&l.loading==="lazy"||l.lazy),n=()=>{Ne&&(C.value=!0,$.value=!1,r.value=l.src)};function _(e){C.value=!1,$.value=!1,m("load",e)}function M(e){C.value=!1,$.value=!0,m("error",e)}function J(e){e&&(n(),G())}const W=Zt(J,200,!0);async function X(){var e;if(!Ne)return;await Te();const{scrollContainer:s}=l;if(Ht(s))T.value=s;else if(tt(s)&&s!=="")T.value=(e=document.querySelector(s))!=null?e:void 0;else if(P.value){const E=We(P.value);T.value=Wt(E)?void 0:E}const{stop:f}=Gt(P,([E])=>{W(E.isIntersecting)},{root:T});O=f}function G(){!Ne||!W||(O?.(),T.value=void 0,O=void 0)}function Y(){V.value&&(K.value=!0,m("show"))}function ae(){K.value=!1,m("close")}function re(e){m("switch",e)}return me(()=>l.src,()=>{I.value?(C.value=!0,$.value=!1,G(),X()):n()}),Se(()=>{I.value?X():n()}),h({showPreview:Y}),(e,s)=>(w(),B("div",Ye({ref_key:"container",ref:P},t(p),{class:[t(g).b(),e.$attrs.class]}),[$.value?U(e.$slots,"error",{key:0},()=>[v("div",{class:A(t(g).e("error"))},x(t(b)("el.image.error")),3)]):(w(),B(Ve,{key:1},[r.value!==void 0?(w(),B("img",Ye({key:0},t(L),{src:r.value,loading:e.loading,style:t(Q),class:t(y),crossorigin:e.crossorigin,onClick:Y,onLoad:_,onError:M}),null,16,["src","loading","crossorigin"])):q("v-if",!0),C.value?(w(),B("div",{key:1,class:A(t(g).e("wrapper"))},[U(e.$slots,"placeholder",{},()=>[v("div",{class:A(t(g).e("placeholder"))},null,2)])],2)):q("v-if",!0)],64)),t(V)?(w(),B(Ve,{key:2},[K.value?(w(),j(t(Ca),{key:0,"z-index":e.zIndex,"initial-index":t(te),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"show-progress":e.showProgress,"url-list":e.previewSrcList,scale:e.scale,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:ae,onSwitch:re},et({toolbar:c(f=>[U(e.$slots,"toolbar",Pe(Ae(f)))]),default:c(()=>[e.$slots.viewer?(w(),B("div",{key:0},[U(e.$slots,"viewer")])):q("v-if",!0)]),_:2},[e.$slots.progress?{name:"progress",fn:c(f=>[U(e.$slots,"progress",Pe(Ae(f)))])}:void 0,e.$slots["viewer-error"]?{name:"viewer-error",fn:c(f=>[U(e.$slots,"viewer-error",Pe(Ae(f)))])}:void 0]),1032,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","scale","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):q("v-if",!0)],64)):q("v-if",!0)],16))}});var Pa=he(Ra,[["__file","image.vue"]]);const Aa=we(Pa),La=ye({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.MAX_SAFE_INTEGER},min:{type:Number,default:Number.MIN_SAFE_INTEGER},modelValue:{type:[Number,null]},readonly:Boolean,disabled:Boolean,size:Qt,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:o=>o===null||H(o)||["min","max"].includes(o),default:null},name:String,placeholder:String,precision:{type:Number,validator:o=>o>=0&&o===Number.parseInt(`${o}`,10)},validateEvent:{type:Boolean,default:!0},...ct(["ariaLabel"]),inputmode:{type:ee(String),default:void 0},align:{type:ee(String),default:"center"},disabledScientific:Boolean}),Oa={[ze]:(o,h)=>h!==o,blur:o=>o instanceof FocusEvent,focus:o=>o instanceof FocusEvent,[Ce]:o=>H(o)||ke(o),[ge]:o=>H(o)||ke(o)},Da=Z({name:"ElInputNumber"}),Ma=Z({...Da,props:La,emits:Oa,setup(o,{expose:h,emit:m}){const l=o,{t:b}=Fe(),g=_e("input-number"),a=R(),p=at({currentValue:l.modelValue,userInput:null}),{formItem:L}=dt(),r=N(()=>H(l.modelValue)&&l.modelValue<=l.min),$=N(()=>H(l.modelValue)&&l.modelValue>=l.max),C=N(()=>{const e=y(l.step);return $e(l.precision)?Math.max(y(l.modelValue),e):(e>l.precision&&Ee("InputNumber","precision should not be less than the decimal places of step"),l.precision)}),K=N(()=>l.controls&&l.controlsPosition==="right"),P=ft(),T=mt(),k=N(()=>{if(p.userInput!==null)return p.userInput;let e=p.currentValue;if(ke(e))return"";if(H(e)){if(Number.isNaN(e))return"";$e(l.precision)||(e=e.toFixed(l.precision))}return e}),O=(e,s)=>{if($e(s)&&(s=C.value),s===0)return Math.round(e);let f=String(e);const E=f.indexOf(".");if(E===-1||!f.replace(".","").split("")[E+s])return e;const ie=f.length;return f.charAt(ie-1)==="5"&&(f=`${f.slice(0,Math.max(0,ie-1))}6`),Number.parseFloat(Number(f).toFixed(s))},y=e=>{if(ke(e))return 0;const s=e.toString(),f=s.indexOf(".");let E=0;return f!==-1&&(E=s.length-f-1),E},Q=(e,s=1)=>H(e)?e>=Number.MAX_SAFE_INTEGER&&s===1?(Ee("InputNumber","The value has reached the maximum safe integer limit."),e):e<=Number.MIN_SAFE_INTEGER&&s===-1?(Ee("InputNumber","The value has reached the minimum safe integer limit."),e):O(e+l.step*s):p.currentValue,V=e=>{const s=Je(e),f=sa(e);if(l.disabledScientific&&["e","E"].includes(f)){e.preventDefault();return}switch(s){case fe.up:{e.preventDefault(),te();break}case fe.down:{e.preventDefault(),I();break}}},te=()=>{if(l.readonly||T.value||$.value)return;const e=Number(k.value)||0,s=Q(e);_(s),m(Ce,p.currentValue),ae()},I=()=>{if(l.readonly||T.value||r.value)return;const e=Number(k.value)||0,s=Q(e,-1);_(s),m(Ce,p.currentValue),ae()},n=(e,s)=>{const{max:f,min:E,step:d,precision:S,stepStrictly:ie,valueOnClear:ue}=l;f<E&&Ze("InputNumber","min should not be greater than max.");let z=Number(e);if(ke(e)||Number.isNaN(z))return null;if(e===""){if(ue===null)return null;z=tt(ue)?{min:E,max:f}[ue]:ue}return ie&&(z=O(Math.round(O(z/d))*d,S),z!==e&&s&&m(ge,z)),$e(S)||(z=O(z,S)),(z>f||z<E)&&(z=z>f?f:E,s&&m(ge,z)),z},_=(e,s=!0)=>{var f;const E=p.currentValue,d=n(e);if(!s){m(ge,d);return}E===d&&e||(p.userInput=null,m(ge,d),E!==d&&m(ze,d,E),l.validateEvent&&((f=L?.validate)==null||f.call(L,"change").catch(S=>Ee(S))),p.currentValue=d)},M=e=>{p.userInput=e;const s=e===""?null:Number(e);m(Ce,s),_(s,!1)},J=e=>{const s=e!==""?Number(e):"";(H(s)&&!Number.isNaN(s)||e==="")&&_(s),ae(),p.userInput=null},W=()=>{var e,s;(s=(e=a.value)==null?void 0:e.focus)==null||s.call(e)},X=()=>{var e,s;(s=(e=a.value)==null?void 0:e.blur)==null||s.call(e)},G=e=>{m("focus",e)},Y=e=>{var s,f;p.userInput=null,p.currentValue===null&&((s=a.value)!=null&&s.input)&&(a.value.input.value=""),m("blur",e),l.validateEvent&&((f=L?.validate)==null||f.call(L,"blur").catch(E=>Ee(E)))},ae=()=>{p.currentValue!==l.modelValue&&(p.currentValue=l.modelValue)},re=e=>{document.activeElement===e.target&&e.preventDefault()};return me(()=>l.modelValue,(e,s)=>{const f=n(e,!0);p.userInput===null&&f!==s&&(p.currentValue=f)},{immediate:!0}),me(()=>l.precision,()=>{p.currentValue=n(l.modelValue)}),Se(()=>{var e;const{min:s,max:f,modelValue:E}=l,d=(e=a.value)==null?void 0:e.input;if(d.setAttribute("role","spinbutton"),Number.isFinite(f)?d.setAttribute("aria-valuemax",String(f)):d.removeAttribute("aria-valuemax"),Number.isFinite(s)?d.setAttribute("aria-valuemin",String(s)):d.removeAttribute("aria-valuemin"),d.setAttribute("aria-valuenow",p.currentValue||p.currentValue===0?String(p.currentValue):""),d.setAttribute("aria-disabled",String(T.value)),!H(E)&&E!=null){let S=Number(E);Number.isNaN(S)&&(S=null),m(ge,S)}d.addEventListener("wheel",re,{passive:!1})}),Jt(()=>{var e,s;const f=(e=a.value)==null?void 0:e.input;f?.setAttribute("aria-valuenow",`${(s=p.currentValue)!=null?s:""}`)}),h({focus:W,blur:X}),(e,s)=>(w(),B("div",{class:A([t(g).b(),t(g).m(t(P)),t(g).is("disabled",t(T)),t(g).is("without-controls",!e.controls),t(g).is("controls-right",t(K)),t(g).is(e.align,!!e.align)]),onDragstart:Qe(()=>{},["prevent"])},[e.controls?De((w(),B("span",{key:0,role:"button","aria-label":t(b)("el.inputNumber.decrease"),class:A([t(g).e("decrease"),t(g).is("disabled",t(r))]),onKeydown:He(I,["enter"])},[U(e.$slots,"decrease-icon",{},()=>[u(t(ne),null,{default:c(()=>[t(K)?(w(),j(t(ea),{key:0})):(w(),j(t(ta),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[t(je),I]]):q("v-if",!0),e.controls?De((w(),B("span",{key:1,role:"button","aria-label":t(b)("el.inputNumber.increase"),class:A([t(g).e("increase"),t(g).is("disabled",t($))]),onKeydown:He(te,["enter"])},[U(e.$slots,"increase-icon",{},()=>[u(t(ne),null,{default:c(()=>[t(K)?(w(),j(t(aa),{key:0})):(w(),j(t(la),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[t(je),te]]):q("v-if",!0),u(t(Ge),{id:e.id,ref_key:"input",ref:a,type:"number",step:e.step,"model-value":t(k),placeholder:e.placeholder,readonly:e.readonly,disabled:t(T),size:t(P),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,inputmode:e.inputmode,onKeydown:V,onBlur:Y,onFocus:G,onInput:M,onChange:J},et({_:2},[e.$slots.prefix?{name:"prefix",fn:c(()=>[U(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:c(()=>[U(e.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","inputmode"])],42,["onDragstart"]))}});var Fa=he(Ma,[["__file","input-number.vue"]]);const Ba=we(Fa),qa=["start","center","end","space-around","space-between","space-evenly"],ja=["top","middle","bottom"],Ua=ye({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:qa,default:"start"},align:{type:String,values:ja}}),Ka=Z({name:"ElRow"}),Xa=Z({...Ka,props:Ua,setup(o){const h=o,m=_e("row"),l=N(()=>h.gutter);na(ot,{gutter:l});const b=N(()=>{const a={};return h.gutter&&(a.marginRight=a.marginLeft=`-${h.gutter/2}px`),a}),g=N(()=>[m.b(),m.is(`justify-${h.justify}`,h.justify!=="start"),m.is(`align-${h.align}`,!!h.align)]);return(a,p)=>(w(),j(Me(a.tag),{class:A(t(g)),style:ve(t(b))},{default:c(()=>[U(a.$slots,"default")]),_:3},8,["class","style"]))}});var Ya=he(Xa,[["__file","row.vue"]]);const Ha=we(Ya),Wa={class:"image-grid"},Ga=Z({__name:"ImagePreview",props:{images:{},size:{}},setup(o){const h=o,m=h.size??72;return(l,b)=>{const g=Aa;return w(),B("div",Wa,[(w(!0),B(Ve,null,lt(h.images,(a,p)=>(w(),j(g,{key:p,src:a,"preview-src-list":h.images,"initial-index":p,fit:"cover",style:ve({width:`${t(m)}px`,height:`${t(m)}px`}),lazy:""},null,8,["src","preview-src-list","initial-index","style"]))),128))])}}}),Za=st(Ga,[["__scopeId","data-v-c8fa6aba"]]),Qa={class:"page-detail"},Ja={key:0,class:"header"},el={class:"header-right"},tl={class:"card-header"},al={class:"item-list"},ll={class:"item-header"},sl={class:"item-code"},nl={class:"item-meta"},ol={class:"item-body"},rl={class:"item-info"},il={class:"item-form"},ul={class:"card-header"},cl={class:"summary-content"},dl={class:"summary-value"},fl=Z({__name:"QuotationDetail",setup(o){const h=oa(),m=ia(),l=h.params.id,b=R(!1),g=R(!1),a=R(null),p=R(!1),L=R(""),r=at({}),$=R(""),C=N(()=>a.value?a.value.status!=="expired"&&a.value.status!=="closed":!1),K=N(()=>a.value?a.value.items.reduce((I,n)=>{const _=y(n.itemId);return _.quotedPrice?I+_.quotedPrice*n.quantity:I},0):0);let P=null;const T=async()=>{b.value=!0;try{const I=await Le.quotations.getDetail(l);a.value=I,$.value=I.remarks??"",k(I.items)}finally{b.value=!1}},k=I=>{Object.keys(r).forEach(n=>{delete r[n]}),I.forEach(n=>{r[n.itemId]={itemId:n.itemId,quotedPrice:n.quotedPrice,deliveryDays:n.deliveryDays,brand:n.brand,origin:n.origin,warranty:n.warranty,itemRemarks:n.itemRemarks}})},O=()=>{C.value&&(P&&globalThis.clearTimeout(P),P=globalThis.setTimeout(Q,1500))},y=I=>(r[I]||(r[I]={itemId:I}),r[I]),Q=async()=>{if(a.value){p.value=!0;try{const I={items:Object.values(r).map(_=>({itemId:_.itemId,quotedPrice:_.quotedPrice,deliveryDays:_.deliveryDays,brand:_.brand,origin:_.origin,warranty:_.warranty,itemRemarks:_.itemRemarks}))},n=await Le.quotations.saveDraft(a.value.id,I);L.value=`已自动保存 ${new Date(n.savedAt).toLocaleTimeString()}`}finally{p.value=!1}}},V=()=>{if(!a.value)return!1;for(const I of a.value.items){const n=y(I.itemId);if(!n||!n.quotedPrice||!n.deliveryDays)return!1}return!0},te=async()=>{if(a.value){g.value=!0;try{const I={items:a.value.items.map(n=>({...y(n.itemId),itemId:n.itemId})),remarks:$.value};await Le.quotations.submit(a.value.id,I),await T(),m.push("/history")}finally{g.value=!1}}};return Se(T),me(r,()=>O(),{deep:!0}),ra(()=>{P&&(globalThis.clearTimeout(P),P=null)}),(I,n)=>{const _=pt,M=Et,J=Nt,W=yt,X=Ba,G=_t,Y=Ge,ae=ht,re=Na,e=wt,s=ya,f=Ha,E=gt;return De((w(),B("div",Qa,[a.value?(w(),B("header",Ja,[v("div",null,[v("h1",null,x(a.value.projectName),1),v("p",null,"报价单号："+x(a.value.quotationNo)+" · 氚云编号："+x(a.value.qingyunId),1)]),v("div",el,[u(bt,{status:a.value.status},null,8,["status"]),C.value?(w(),j(ua,{key:0,"end-date":a.value.endDate},null,8,["end-date"])):q("",!0),u(_,{type:"primary",plain:"",onClick:n[0]||(n[0]=d=>t(m).back())},{default:c(()=>[...n[2]||(n[2]=[se("返回",-1)])]),_:1})])])):q("",!0),a.value?(w(),j(f,{key:1,gutter:24},{default:c(()=>[u(re,{lg:16,md:24},{default:c(()=>[u(W,{class:"info-card"},{header:c(()=>[...n[3]||(n[3]=[v("div",{class:"card-header"},[v("h2",null,"报价单信息")],-1)])]),default:c(()=>[u(J,{column:2,border:""},{default:c(()=>[u(M,{label:"报价起止"},{default:c(()=>[se(x(a.value.startDate.slice(0,10))+" 至 "+x(a.value.endDate.slice(0,10)),1)]),_:1}),u(M,{label:"联系人"},{default:c(()=>[se(x(a.value.contactPerson),1)]),_:1}),u(M,{label:"联系电话"},{default:c(()=>[se(x(a.value.contactPhone),1)]),_:1}),u(M,{label:"交货地址"},{default:c(()=>[se(x(a.value.deliveryAddress),1)]),_:1}),u(M,{label:"付款条款",span:2},{default:c(()=>[se(x(a.value.paymentTerms),1)]),_:1}),u(M,{label:"备注",span:2},{default:c(()=>[se(x(a.value.remarks||"—"),1)]),_:1})]),_:1})]),_:1}),u(W,{class:"info-card"},{header:c(()=>[v("div",tl,[n[4]||(n[4]=v("h2",null,"物品清单",-1)),v("span",null,"共 "+x(a.value.items.length)+" 项",1)])]),default:c(()=>[v("div",al,[(w(!0),B(Ve,null,lt(a.value.items,d=>(w(),j(W,{key:d.itemId,class:"item-card",shadow:"hover"},{default:c(()=>[v("div",ll,[v("div",null,[v("p",sl,"#"+x(d.itemNo),1),v("h3",null,x(d.itemName),1)]),v("div",nl,[v("p",null,"数量："+x(d.quantity)+" "+x(d.unit),1),v("p",null,"交货日期："+x(d.requiredDeliveryDate.slice(0,10)),1)])]),v("div",ol,[v("div",rl,[v("p",null,"规格："+x(d.specification),1),v("p",null,"说明："+x(d.description),1),v("p",null,"备注："+x(d.remarks||"—"),1),d.images?.length?(w(),j(Za,{key:0,images:d.images},null,8,["images"])):q("",!0)]),v("div",il,[u(ae,{"label-position":"top",disabled:!C.value},{default:c(()=>[u(G,{label:"报价单价 (元)",required:""},{default:c(()=>[u(X,{modelValue:y(d.itemId).quotedPrice,"onUpdate:modelValue":S=>y(d.itemId).quotedPrice=S,min:0,precision:2,step:10,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),u(G,{label:"交货天数",required:""},{default:c(()=>[u(X,{modelValue:y(d.itemId).deliveryDays,"onUpdate:modelValue":S=>y(d.itemId).deliveryDays=S,min:1,step:1,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),u(G,{label:"品牌"},{default:c(()=>[u(Y,{modelValue:y(d.itemId).brand,"onUpdate:modelValue":S=>y(d.itemId).brand=S,modelModifiers:{trim:!0},placeholder:"可选"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),u(G,{label:"产地"},{default:c(()=>[u(Y,{modelValue:y(d.itemId).origin,"onUpdate:modelValue":S=>y(d.itemId).origin=S,modelModifiers:{trim:!0},placeholder:"可选"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),u(G,{label:"质保期"},{default:c(()=>[u(Y,{modelValue:y(d.itemId).warranty,"onUpdate:modelValue":S=>y(d.itemId).warranty=S,modelModifiers:{trim:!0},placeholder:"可选"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),u(G,{label:"物品备注"},{default:c(()=>[u(Y,{modelValue:y(d.itemId).itemRemarks,"onUpdate:modelValue":S=>y(d.itemId).itemRemarks=S,modelModifiers:{trim:!0},type:"textarea",rows:2},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["disabled"])])])]),_:2},1024))),128))])]),_:1})]),_:1}),u(re,{lg:8,md:24},{default:c(()=>[u(s,{offset:24},{default:c(()=>[u(W,{class:"summary-card"},{header:c(()=>[v("div",ul,[n[5]||(n[5]=v("h2",null,"报价概览",-1)),v("span",null,x(a.value.quotedItemCount)+"/"+x(a.value.itemCount)+" 已报价",1)])]),default:c(()=>[v("div",cl,[v("p",dl,"¥ "+x(K.value.toFixed(2)),1),n[8]||(n[8]=v("p",{class:"summary-desc"},"自动计算所有物品的报价合计金额",-1)),u(ae,{"label-position":"top",disabled:!C.value},{default:c(()=>[u(G,{label:"整体备注"},{default:c(()=>[u(Y,{modelValue:$.value,"onUpdate:modelValue":n[1]||(n[1]=d=>$.value=d),modelModifiers:{trim:!0},type:"textarea",rows:4,placeholder:"填写补充说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["disabled"]),L.value?(w(),j(e,{key:0,title:L.value,type:"info",closable:!1,"show-icon":""},null,8,["title"])):q("",!0),C.value?(w(),j(_,{key:1,type:"primary",size:"large",disabled:!V()||p.value,loading:g.value,onClick:te},{default:c(()=>[...n[6]||(n[6]=[se(" 提交报价 ",-1)])]),_:1},8,["disabled","loading"])):(w(),j(_,{key:2,size:"large",disabled:""},{default:c(()=>[...n[7]||(n[7]=[se("此报价单不可编辑",-1)])]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})):q("",!0)])),[[E,b.value]])}}}),Il=st(fl,[["__scopeId","data-v-f1bb81b8"]]);export{Il as default};
